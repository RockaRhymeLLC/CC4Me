{
  "statusLine": {
    "type": "command",
    "command": "/Users/bmo/CC4Me-BMO/scripts/context-monitor-statusline.sh",
    "padding": 0
  },
  "hooks": {
    "SessionStart": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "\"$CLAUDE_PROJECT_DIR\"/.claude/hooks/session-start.sh",
            "timeout": 10
          }
        ]
      }
    ],
    "PreCompact": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "\"$CLAUDE_PROJECT_DIR\"/.claude/hooks/pre-compact.sh",
            "timeout": 10
          }
        ]
      }
    ],
    "UserPromptSubmit": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "\"$CLAUDE_PROJECT_DIR\"/.claude/hooks/set-channel.sh",
            "timeout": 5
          }
        ]
      },
      {
        "hooks": [
          {
            "type": "command",
            "command": "\"$CLAUDE_PROJECT_DIR\"/.claude/hooks/notify-response.sh",
            "timeout": 5
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "\"$CLAUDE_PROJECT_DIR\"/.claude/hooks/notify-response.sh",
            "timeout": 5
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "\"$CLAUDE_PROJECT_DIR\"/.claude/hooks/notify-response.sh",
            "timeout": 15
          }
        ]
      },
      {
        "hooks": [
          {
            "type": "agent",
            "prompt": "You are a memory extraction agent for a personal assistant.\n\nINPUT (JSON): $ARGUMENTS\n\nTASK: Read the recent conversation transcript and extract any NEW persistent facts worth remembering. Write each fact as an individual memory file.\n\nRULES:\n1. Check the stop_hook_active field in the input JSON. If it is true, respond immediately with {\"ok\": true} and do nothing else. This prevents infinite loops.\n2. FIRST, run `date '+%Y%m%d-%H%M'` via Bash to get the accurate current timestamp. Use this for all filenames and frontmatter dates. Do NOT rely on your system prompt date — it may be stale.\n3. Read the transcript JSONL file at the transcript_path from the input JSON. Focus on the LAST assistant message and the user message that triggered it. Read only the last 200 lines of the transcript file to stay fast.\n4. Look for NEW persistent facts in these categories:\n   - person: Names, relationships, contact info, preferences about specific people\n   - preference: How the user likes things done, tool choices, style preferences\n   - technical: Environment details, architecture decisions, tool configurations\n   - account: Service accounts, usernames, non-secret identifiers\n   - decision: Significant decisions made (with reasoning if stated)\n5. For each candidate fact, search .claude/state/memory/memories/ with Grep to check if it already exists. Skip duplicates.\n6. Only write a memory file if ALL of these are true:\n   - The fact is genuinely persistent (not transient session context)\n   - It does not already exist in memories/\n   - It was stated by the user or is a clear factual outcome (not inferred or speculative)\n   - It would be useful to recall in a future session\n7. Write each new memory file to .claude/state/memory/memories/ using this format:\n   - Filename: YYYYMMDD-HHMM-slug.md (use the timestamp from step 2)\n   - YAML frontmatter with ALL fields: date (ISO 8601 from step 2), category, importance, subject, tags, confidence, source\n   - Set source: auto-extraction\n   - Set confidence: 0.7\n   - Markdown body with the fact details\n8. Quality over quantity. Extracting 0 facts is perfectly fine and expected for most turns. Most conversations are routine operations with nothing new to remember.\n9. Do NOT extract: temporary task context, file paths being worked on, routine operations, things already tracked in todos, code snippets, error messages, or implementation details.\n10. Do NOT extract secrets, passwords, API keys, or sensitive credentials.\n\nRESPOND with {\"ok\": true} when done. Never respond with {\"ok\": false} — memory extraction must never block the main agent from stopping.",
            "timeout": 60
          }
        ]
      }
    ]
  }
}
